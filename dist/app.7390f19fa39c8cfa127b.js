!function(n){var e={};function t(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return n[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=n,t.c=e,t.d=function(n,e,o){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:o})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var a in n)t.d(o,a,function(e){return n[e]}.bind(null,a));return o},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}({"//1v":function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesConfigForm",{templateUrl:"/james/app/config-form/james-config-form.html",controller:"jamesConfigFormController",bindings:{configurations:"=",mode:"@",availableModes:"<"},require:{adminModulesDisplayerController:"^adminModulesDisplayer"}})}(angular)},0:function(n,e,t){t("9kT/"),t("VTQ0"),t("VH2o"),t("0ykG"),t("OUvX"),t("EvQ5"),t("//1v"),t("iUH0"),t("9dyt"),t("HT+J"),t("Vrcu"),t("3oUb"),t("EUDV"),t("dzDA"),t("BnEG"),t("8nRQ"),t("w/Jx"),t("tbht"),t("22oh"),t("Ks/5"),t("cEFI"),t("c68H"),t("y8Aj"),t("FODK"),t("VveY"),t("y/XK"),t("0cO/"),t("HWhK"),t("NTEm"),t("GbwM"),t("1sNg"),n.exports=t("PXw8")},"0cO/":function(n,e){!function(n){"use strict";function e(n,e,t,o,a){var i=this,r="loading",s="loaded",u="error";i.updateUserQuota=function(){return e({progressing:"Updating quota...",success:"Quota updated",failure:"Failed to update quota"},(function(){return t.setUserQuota(n.domain._id,i.user._id,o.qualifySet(i.quota))}))},i.init=function(){return i.status=r,i.userDisplayName=a.displayNameOf(i.user),t.getUserQuota(n.domain._id,i.user._id).then((function(n){i.quota=o.qualifyGet(n.user),i.computedQuota=o.qualifyGet(n.computed),i.status=s})).catch((function(){i.status=u}))}}e.$inject=["session","asyncAction","jamesApiClient","jamesQuotaHelpers","userUtils"],n.module("linagora.esn.james").controller("jamesQuotaUserController",e)}(angular)},"0ykG":function(n,e){!function(n){"use strict";function e(n){var e=new n.DynamicDirective(!0,"james-sync-status-indicator",{attributes:[{name:"ng-if",value:"$ctrl.group"},{name:"resource-type",value:"group"},{name:"resource-id",value:"{{$ctrl.group.id}}"}]});n.addInjection("group-display-subheader-actions",e)}function t(n,e){n.add(e)}e.$inject=["dynamicDirectiveService"],t.$inject=["esnModuleRegistry","JAMES_MODULE_METADATA"],n.module("linagora.esn.james").run(e).run(t)}(angular)},"1sNg":function(n,e){!function(n){"use strict";function e(n,e){return{getStatus:t,sync:function(o){return e.syncGroup(o).then((function(){return t(o).then((function(e){if(!e.ok)return n.reject("Failed to synchronize group")}))}))},errorMessage:"This group data does not synchronize with mail group in James."};function t(n){return e.getGroupSyncStatus(n).then((function(n){return n.data}))}}e.$inject=["$q","jamesApiClient"],n.module("linagora.esn.james").factory("jamesGroupSynchronizer",e)}(angular)},"22oh":function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesQuotaDomain",{templateUrl:"/james/app/quota/domain/james-quota-domain.html",controller:"JamesQuotaDomainController",bindings:{domain:"<"}})}(angular)},"3oUb":function(n,e){!function(n){"use strict";function e(n,e){var t=this;function o(){return e.removeDomainAlias(t.domain.id,t.alias).then((function(){t.aliases=t.aliases.filter((function(n){return n!==t.alias}))}))}function a(){n({progressing:"Removing alias...",success:"Alias removed",failure:"Failed to remove alias"},o)}t.$onInit=function(){t.removeAlias=a}}e.$inject=["asyncAction","jamesApiClient"],n.module("linagora.esn.james").controller("JamesDomainAliasItemController",e)}(angular)},"8nRQ":function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesMaintenance",{templateUrl:"/james/app/maintenance/james-maintenance.html",controller:"jamesMaintenanceController"})}(angular)},"9dyt":function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesDomainAliasForm",{templateUrl:"/james/app/domain/alias/form/james-domain-alias-form.html",controller:"JamesDomainAliasFormController",bindings:{domain:"<",aliases:"="}})}(angular)},"9kT/":function(n,e){!function(n){"use strict";n.module("linagora.esn.james",["restangular","op.dynamicDirective","esn.async-action","esn.http","esn.router","esn.i18n","esn.ui","esn.module-registry","esn.configuration","esn.user","esn.session","esn.domain","ngFileSaver","ngSanitize","ui.select"])}(angular)},BnEG:function(n,e){!function(n){"use strict";function e(n){var e=new n.DynamicDirective(!0,"james-domain-alias",{attributes:[{name:"domain",value:"$ctrl.domain"}]});n.addInjection("admin-domains-list-menu-items",e)}e.$inject=["dynamicDirectiveService"],n.module("linagora.esn.james").run(e)}(angular)},EUDV:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesDomainAlias",{templateUrl:"/james/app/domain/alias/james-domain-alias.html",controller:"JamesDomainAliasController",bindings:{domain:"<"}})}(angular)},EvQ5:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").factory("jamesRestangular",["Restangular","httpErrorHandler",function(n,e){return n.withConfig((function(n){n.setFullResponse(!0),n.setBaseUrl("/james/api"),n.setErrorInterceptor((function(n){return 401===n.status&&e.redirectToLogin(),!0}))}))}])}(angular)},FODK:function(n,e){!function(n){"use strict";function e(e){var t=null;return{qualifyGet:function(o,a){a=a||t;var i=n.copy(o)||{};return i.size=i.size>0||i.size===e?i.size:a,i.count=i.count>0||i.count===e?i.count:a,i},qualifySet:function(o,a){a=a||t;var i=n.copy(o)||{};return i.size=i.size>0||i.size===e?i.size:a,i.count=i.count>0||i.count===e?i.count:a,i}}}e.$inject=["JAMES_UNLIMITED_QUOTA"],n.module("linagora.esn.james").factory("jamesQuotaHelpers",e)}(angular)},GbwM:function(n,e){!function(n){"use strict";function e(n,e){var t,o=this,a={progressing:"Synchronizing group...",success:"Group synchronized",failure:"Failed to synchronize group"};o.$onInit=function(){if(o.syncError=!1,!(t=e.get(o.resourceType)))throw new Error("No such resourceType:",o.resourceType);o.errorMessage=t.errorMessage,t.getStatus(o.resourceId).then((function(n){o.syncError=!n.ok})).catch((function(){o.syncError=!0}))},o.sync=function(){return n(a,(function(){return t.sync(o.resourceId).then((function(){o.syncError=!1}))}))}}e.$inject=["asyncAction","jamesSynchronizerService"],n.module("linagora.esn.james").controller("JamesSyncStatusIndicatorController",e)}(angular)},"HT+J":function(n,e){!function(n){"use strict";function e(n,e){var t=this;function o(n){return-1!==t.aliases.indexOf(n)}function a(){return e.addDomainAlias(t.domain.id,t.alias).then((function(){t.aliases.push(t.alias),t.alias=""}))}function i(){n({progressing:"Adding alias...",success:"Alias added",failure:"Failed to add alias"},a)}t.$onInit=function(){t.alias="",t.status="loading",t.onAddBtnClick=i,t.isAddedAlias=o,e.listJamesDomains().then((function(n){var e=n.indexOf(t.domain.name);return-1!==e&&n.splice(e,1),n})).then((function(n){t.availableAliases=n,t.status="loaded"})).catch((function(){t.status="error"}))}}e.$inject=["asyncAction","jamesApiClient"],n.module("linagora.esn.james").controller("JamesDomainAliasFormController",e)}(angular)},HWhK:function(n,e){!function(n){"use strict";function e(n){var e=new n.DynamicDirective(!0,"james-quota-user",{attributes:[{name:"user",value:"member"}]});n.addInjection("admin-user-list-menu-items",e)}e.$inject=["dynamicDirectiveService"],n.module("linagora.esn.james").run(e)}(angular)},"Ks/5":function(n,e){!function(n){"use strict";function e(n,e,t){var o=this,a={loading:"loading",loaded:"loaded",error:"error"};o.$onInit=function(){o.getDomainQuotaStatus=a},o.getDomainQuota=function(){return o.status=a.loading,e.getDomainQuota(o.domain.id).then((function(n){o.quota=t.qualifyGet(n.domain),o.computedQuota=t.qualifyGet(n.computed),o.status=a.loaded})).catch((function(){o.status=a.error}))},o.updateDomainQuota=function(){return n({progressing:"Updating quota...",success:"Quota updated",failure:"Failed to update quota"},(function(){return e.setDomainQuota(o.domain.id,t.qualifySet(o.quota))}))}}e.$inject=["asyncAction","jamesApiClient","jamesQuotaHelpers"],n.module("linagora.esn.james").controller("JamesQuotaDomainController",e)}(angular)},NTEm:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesSyncStatusIndicator",{templateUrl:"/james/app/sync/status-indicator/james-sync-status-indicator.html",bindings:{resourceType:"@",resourceId:"@"},controller:"JamesSyncStatusIndicatorController"})}(angular)},OUvX:function(n,e){!function(n){"use strict";function e(n,e){return{addDomainAlias:function(e,t){return n.one("domains",e).one("aliases",t).post()},downloadEmlFileFromMailRepository:function(t,o,a){return n.setDefaultHeaders({accept:"message/rfc822"}).one("domains",t).one("mailRepositories",o).one("mails",a).get().then((function(n){var t=new Blob([n.data],{type:"text/html"});e.saveAs(t,[a,"eml"].join("."))}))},getDlpRule:function(e,t){return n.all("dlp").one("domains",e).one("rules",t).get().then((function(n){return n.data}))},getDomainAliases:function(e){return n.one("domains",e).one("aliases").get().then((function(n){return n.data}))},getDomainQuota:function(e){return n.all("quota").customGET("",{scope:"domain",domain_id:e}).then((function(n){return n.data}))},getDomainsSyncStatus:function(){return n.one("sync").one("domains").get()},getGroupSyncStatus:function(e){return n.one("sync").one("groups",e).get()},getMailFromMailRepository:function(e,t,o,a){return n.one("domains",e).one("mailRepositories",t).one("mails",o).get(a).then((function(n){return n.data}))},getPlatformQuota:function(){return n.all("quota").customGET("",{scope:"platform"}).then((function(n){return n.data}))},getUserQuota:function(e,t){return n.all("quota").get("",{scope:"user",domain_id:e,user_id:t}).then((function(n){return n.data}))},listDlpRules:function(e){return n.all("dlp").one("domains",e).all("rules").getList().then((function(n){return n.data}))},listJamesDomains:function(){return n.one("domains").get().then((function(n){return n.data}))},listMailsFromMailRepository:function(e,t,o){return n.one("domains",e).one("mailRepositories",t).all("mails").getList(o).then((function(n){return n.data}))},removeDomainAlias:function(e,t){return n.one("domains",e).one("aliases",t).remove()},setDomainQuota:function(e,t){return n.all("quota").customPUT(t,"",{domain_id:e,scope:"domain"})},removeAllMailsFromMailRepository:function(e,t){return n.one("domains",e).one("mailRepositories",t).all("mails").remove().then((function(n){return n.data&&n.data.taskId}))},removeMailFromMailRepository:function(e,t,o){return n.one("domains",e).one("mailRepositories",t).one("mails",o).remove()},reprocessAllMailsFromMailRepository:function(e,t,o){return n.one("domains",e).one("mailRepositories",t).all("mails").patch("",o).then((function(n){return n.data&&n.data.taskId}))},reprocessMailFromMailRepository:function(e,t,o,a){return n.one("domains",e).one("mailRepositories",t).one("mails",o).patch("",a).then((function(n){return n.data&&n.data.taskId}))},setPlatformQuota:function(e){return n.all("quota").customPUT(e,"",{scope:"platform"})},setUserQuota:function(e,t,o){return n.all("quota").customPUT(o,"",{domain_id:e,user_id:t,scope:"user"})},storeDlpRules:function(e,t){return n.all("dlp").one("domains",e).all("rules").customPUT(t)},syncGroup:function(e){return n.one("sync").one("groups",e).post()},syncDomains:function(){return n.one("sync").one("domains").post()}}}e.$inject=["jamesRestangular","FileSaver"],n.module("linagora.esn.james").factory("jamesApiClient",e)}(angular)},PXw8:function(n,e){!function(n){"use strict";function e(n){var e={group:n};return{get:function(n){return e[n]}}}e.$inject=["jamesGroupSynchronizer"],n.module("linagora.esn.james").factory("jamesSynchronizerService",e)}(angular)},VH2o:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").config(["$stateProvider",function(n){n.state("james",{url:"/james",template:'<h1>{{ "Hello World" | esnI18n }}</h1>'})}])}(angular)},VTQ0:function(n,e){!function(){"use strict";angular.module("linagora.esn.james").constant("JAMES_MODULE_METADATA",{id:"linagora.esn.james",title:"James",icon:"/james/images/james-icon.svg",config:{template:"james-config-form",displayIn:{user:!1,domain:!0,platform:!0}},maintenance:{template:"james-maintenance",displayIn:{user:!1,domain:!1,platform:!0}}}).constant("JAMES_MODULE_NAME","linagora.esn.james")}()},Vrcu:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesDomainAliasItem",{templateUrl:"/james/app/domain/alias/item/james-domain-alias-item.html",controller:"JamesDomainAliasItemController",bindings:{alias:"<",aliases:"=",domain:"<"}})}(angular)},VveY:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").constant("JAMES_UNLIMITED_QUOTA",-1)}(angular)},c68H:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesQuotaForm",{templateUrl:"/james/app/quota/form/james-quota-form.html",bindings:{quota:"="},controller:"jamesQuotaFormController"})}(angular)},cEFI:function(n,e){!function(n){"use strict";function e(n){var e=new n.DynamicDirective(!0,"james-quota-domain",{attributes:[{name:"domain",value:"$ctrl.domain"}]});n.addInjection("admin-domains-list-menu-items",e)}e.$inject=["dynamicDirectiveService"],n.module("linagora.esn.james").run(e)}(angular)},dzDA:function(n,e){!function(n){"use strict";function e(n){var e=this,t={loading:"loading",loaded:"loaded",error:"error"};e.$onInit=function(){e.getDomainAliasesStatus=t},e.getDomainAliases=function(){return e.status=t.loading,n.getDomainAliases(e.domain.id).then((function(n){e.aliases=n,e.status=t.loaded})).catch((function(){e.status=t.error}))}}e.$inject=["jamesApiClient"],n.module("linagora.esn.james").controller("JamesDomainAliasController",e)}(angular)},iUH0:function(n,e){!function(n){"use strict";a.$inject=["$q","session","jamesQuotaHelpers","jamesApiClient"],n.module("linagora.esn.james").controller("jamesConfigFormController",a);var e="connecting",t="connected",o="error";function a(n,a,i,r){var s=this;function u(){if(s.configurations.webadminApiFrontend.value)return s.connectionStatus=e,s.config={},function(){var n;n=s.mode===s.availableModes.domain?r.getDomainQuota(a.domain._id):r.getPlatformQuota();return n.then((function(n){return{quota:n.domain?i.qualifyGet(n.domain):i.qualifyGet(n),computedQuota:i.qualifyGet(n.computed)}}))}().then((function(n){s.config=n,s.connectionStatus=t})).catch((function(){s.connectionStatus=o}))}function c(){if(s.connectionStatus!==t)return n.when();var e={quota:i.qualifySet(s.config.quota)};return s.mode===s.availableModes.domain?r.setDomainQuota(a.domain._id,e.quota):r.setPlatformQuota(e.quota)}s.$onInit=function(){s.adminModulesDisplayerController.registerPostSaveHandler(c),u()},s.onServerUrlChange=function(n){n.$setPristine(),u()}}}(angular)},tbht:function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesQuotaDisplayer",{templateUrl:"/james/app/quota/displayer/james-quota-displayer.html",bindings:{quota:"<"}})}(angular)},"w/Jx":function(n,e){!function(n){"use strict";function e(n,e){this.synchronizeDomains=function(){return n({progressing:"Synchronizing domains...",success:"Domains synchronized",failure:"Failed to synchronize domains"},(function(){return e.syncDomains()}))}}e.$inject=["asyncAction","jamesApiClient"],n.module("linagora.esn.james").controller("jamesMaintenanceController",e)}(angular)},"y/XK":function(n,e){!function(n){"use strict";n.module("linagora.esn.james").component("jamesQuotaUser",{templateUrl:"/james/app/quota/user/james-quota-user.html",controller:"jamesQuotaUserController",bindings:{user:"<"}})}(angular)},y8Aj:function(n,e){!function(n){"use strict";function e(n,e){var t=this;t.$onInit=function(){t.dataUsageQuota=t.quota.size===e?null:t.quota.size,t.messageCountQuota=t.quota.count===e?null:t.quota.count,t.unlimitedDataUsage=t.quota.size===e,t.unlimitedMessageCount=t.quota.count===e,n.$watch((function(){return t.messageCountQuota}),(function(n){t.quota.count=n})),n.$watch((function(){return t.dataUsageQuota}),(function(n){t.quota.size=n}))},t.onDataUsageUnlimitedCheckboxChange=function(){t.quota.size=t.unlimitedDataUsage?e:t.dataUsageQuota},t.onMessageCountUnlimitedCheckboxChange=function(){t.quota.count=t.unlimitedMessageCount?e:t.messageCountQuota}}e.$inject=["$scope","JAMES_UNLIMITED_QUOTA"],n.module("linagora.esn.james").controller("jamesQuotaFormController",e)}(angular)}});